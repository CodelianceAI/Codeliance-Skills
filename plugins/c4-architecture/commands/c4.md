---
description: Analyse a codebase and generate a C4 architecture model in Structurizr DSL
argument-hint: [update|full]
---

Analyse the current project and generate a C4 architecture model by following the c4-architecture skill instructions. The primary output is `architecture/workspace.dsl`.

**Modes:**

- **`/c4`** or **`/c4 full`** — scan the entire codebase and generate a complete workspace from scratch.
- **`/c4 update`** — read the existing `architecture/workspace.dsl`, diff against the current codebase, and update only what changed.

**Rendering:** After generating the DSL, offer to render SVG diagrams:

```bash
tmpdir=$(mktemp -d)
structurizr-cli export \
  -workspace architecture/workspace.dsl \
  -format plantuml/c4plantuml \
  -output "$tmpdir"
for f in "$tmpdir"/structurizr-*.puml; do mv "$f" "$tmpdir/$(basename "$f" | sed 's/^structurizr-//')"; done
mkdir -p architecture/.diagrams
plantuml -tsvg -o "$(pwd)/architecture/.diagrams" "$tmpdir"/*.puml
rm -rf "$tmpdir"
```

Requires `structurizr-cli` and `plantuml` (`brew install structurizr-cli plantuml`).
